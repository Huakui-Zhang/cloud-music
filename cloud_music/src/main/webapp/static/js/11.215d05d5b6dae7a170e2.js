webpackJsonp([11],{DX1M:function(t,e){},UFWN:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("3cXf"),s=i.n(a),n=i("Hn+D"),o=i("ANMl"),l=i("mx1b"),r=i("T0cg"),c=i.n(r),u={components:{vHead:n.a,vNav:o.a,vFoot:l.a},data:function(){return{dialogVisible:!1,songPage:1,songPageCount:0,albumPage:1,albumPageCount:0,playlist:{id:0,name:"",intro:""},rules:{name:[{required:!0,message:"请输入歌单名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],intro:[{min:1,max:140,message:"长度在 140 个字符以内",trigger:"blur"}]},userID:"",isLogin:"",artist:{},songListView:[],playlistList:[],albumView:[]}},computed:{serverUrl:function(){return this.$store.state.serverUrl},state:function(){return this.$store.state}},created:function(){window.scrollTo(0,0),this.artist.id=this.$route.query.id},mounted:function(){this.isLogin=this.$store.state.isLogin,this.getArtistInfo(this.artist.id),this.getPlaylistList()},methods:{S_pagination:function(t,e){this.songPageCount=Math.ceil(parseFloat(e.length)/10),t!=this.songPage&&(this.songPage=t,this.songListView.splice(0,this.songListView.length));for(var i=e.length<10?e.length:10,a=0;a<i;a++)if(null!=e[10*(this.songPage-1)+a]){var s=e[10*(t-1)+a];this.songListView.push(s)}},A_pagination:function(t,e){this.albumPageCount=Math.ceil(parseFloat(t.length)/4),e!=this.albumPage&&(this.albumPage=e,this.albumView.splice(0,this.albumView.length));for(var i=0;i<4;i++)if(null!=t[4*(this.albumPage-1)+i]){var a=t[4*(this.albumPage-1)+i];this.albumView.push(a)}},setAlbum:function(t){this.$store.state.albums=t},indexMethod:function(t){return 10*(this.songPage-1)+t+1},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},handleCurrentChange:function(t){this.S_pagination(t,this.artist.songList)},handleCurrentChange2:function(t){this.A_pagination(this.artist.albumList,t)},handleMouseEnter:function(t,e,i,a){t.Flag=!0},handleMouseOut:function(t,e,i,a){if(t.isopen)return!1;t.Flag=!1},handle:function(t,e){t.Flag=e,t.isopen=e},playAllSong:function(){this.$store.dispatch("play",[this.artist.songList,0,!1])},playSong:function(t){t=10*(this.songPage-1)+t,this.$store.dispatch("play",[this.artist.songList,t,!1])},handleSongCommand:function(t){var e=this;if("login"==t)this.$router.push({path:"/user/unlogin"});else if("newplaylist"==t)this.dialogVisible=!0;else if("playqueue"==t.type){var i=t.params,a=[this.artist.songList[i]];this.$store.dispatch("addToSongList",a)}else this.axios.get(this.serverUrl+"/playlist/addSong",{params:{songId:t.param2.id,playlistId:t.param1}}).then(function(t){t?e.$message({showClose:!0,message:"已成功添加到歌单",type:"success"}):e.$message({showClose:!0,message:"会话超时",type:"error"})}).catch(function(t){console.log(t)})},submitForm:function(){var t=this;this.$refs.playlist.validate(function(e){if(!e)return t.$message({showClose:!0,message:"格式不正确",type:"error"}),!1;t.axios.get(t.serverUrl+"/playlist/create",{params:{name:t.playlist.name,intro:t.playlist.intro}}).then(function(e){-1!=e?(t.playlist.id=e.data,t.$store.state.playlistList.push(t.playlist),sessionStorage.setItem("playlistList",s()(t.$store.state.playlistList)),t.getPlaylistList(),t.$message({showClose:!0,message:"已成功添加到新歌单",type:"success"}),t.dialogVisible=!1,t.$refs.playlist.resetFields()):t.$message({showClose:!0,message:"会话超时",type:"error"})}).catch(function(t){console.log(t)})})},downloadSong:function(t){var e=this;this.isLogin?window.location.href=this.serverUrl+"/download/downloadSong?id="+t.id:this.$confirm("还未登录,是否现在登录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){e.$router.push({path:"/user/unlogin"})}).catch(function(){})},timestampToTime:function(t){var e=new Date(t),i=e.getFullYear()+"-",a=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-",s=e.getDate();return s<10&&(s="0"+s),i+a+s},getArtistInfo:function(t){var e=this;this.axios.get(this.serverUrl+"/artist/getInfo",{params:{id:this.artist.id}}).then(function(t){e.artist=t.data,console.log(e.artist),null==e.artist.image?e.artist.image=c.a:e.artist.image=e.serverUrl+e.artist.image,e.artist.birthday=e.timestampToTime(e.artist.birthday);for(var i=0;i<e.artist.albumList.length;i++)e.artist.albumList[i].image=e.serverUrl+e.artist.albumList[i].image;for(i=0;i<e.artist.songList.length;i++)e.artist.songList[i].image=e.serverUrl+e.artist.songList[i].image,e.artist.songList[i].filePath=e.serverUrl+e.artist.songList[i].filePath,e.artist.songList[i].lyricsPath=e.serverUrl+e.artist.songList[i].lyricsPath,e.$set(e.artist.songList[i],"Flag",!1),e.$set(e.artist.songList[i],"isopen",!1);e.$set(e.artist,"isCollected",!1),e.S_pagination(e.songPage,e.artist.songList),e.A_pagination(e.artist.albumList,e.albumPage)}).catch(function(t){console.log(t)})},getPlaylistList:function(){if(!this.isLogin)return!1;this.playlistList=this.$store.state.playlistList}}},p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("v-head"),t._v(" "),i("v-nav"),t._v(" "),i("div",{staticClass:"main",staticStyle:{width:"auto"},attrs:{id:"artistdetail",data:t.artist}},[i("el-row",[i("el-col",{attrs:{span:4,offset:4}},[i("div",[i("img",{staticStyle:{float:"left","margin-top":"30px","border-radius":"100%",width:"230px",height:"230px",overflow:"hidden"},attrs:{align:"right",src:t.artist.image}})])]),t._v(" "),i("el-col",{staticStyle:{"margin-left":"30px","margin-top":"30px"},attrs:{span:12}},[i("div",{staticStyle:{width:"500px"}},[i("p",{staticClass:"font_artistName"},[t._v(t._s(t.artist.name))])]),t._v(" "),i("div",{staticStyle:{width:"800px",height:"5px"}}),t._v(" "),i("div",{staticStyle:{width:"700px","margin-top":"5px"}},[i("p",{staticClass:"font_des",staticStyle:{width:"600px",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":"1",overflow:"hidden",float:"left"}},[null!=t.artist.country?i("span",[t._v("国籍：")]):t._e(),t._v(t._s(t.artist.country)+"\n                "),null!=t.artist.birthplace?i("span",[t._v(" 出生地：")]):t._e(),t._v(t._s(t.artist.birthplace)+"\n                "),null!=t.artist.birthday?i("span",[t._v(" 生日：")]):t._e(),t._v(t._s(t.artist.birthday)+"\n                "),null!=t.artist.occupation?i("span",[t._v(" 职业：")]):t._e(),t._v(t._s(t.artist.occupation)+"\n                "),null!=t.artist.representative?i("span",[t._v(" 代表作：")]):t._e(),t._v(t._s(t.artist.representative)+"\n                "),null!=t.artist.intro?i("span",[t._v(" 简介：")]):t._e(),t._v(t._s(t.artist.intro))]),t._v(" "),i("el-popover",{attrs:{placement:"left",title:"歌手简介",trigger:"click"}},[i("p",{staticClass:"font_des",staticStyle:{width:"560px"}},[null!=t.artist.country?i("span",[t._v("国籍：")]):t._e(),t._v(t._s(t.artist.country)),i("br"),t._v(" "),null!=t.artist.birthplace?i("span",[t._v(" 出生地：")]):t._e(),t._v(t._s(t.artist.birthplace)),i("br"),t._v(" "),null!=t.artist.birthday?i("span",[t._v(" 生日：")]):t._e(),t._v(t._s(t.artist.birthday)),i("br"),t._v(" "),null!=t.artist.occupation?i("span",[t._v(" 职业：")]):t._e(),t._v(t._s(t.artist.occupation)),i("br"),t._v(" "),null!=t.artist.representative?i("span",[t._v(" 代表作：")]):t._e(),t._v(t._s(t.artist.representative)),i("br"),t._v(" "),null!=t.artist.intro?i("span",[t._v(" 简介：")]):t._e(),t._v(t._s(t.artist.intro))]),t._v(" "),i("el-button",{staticStyle:{color:"black","padding-top":"8px",float:"left"},attrs:{slot:"reference",type:"text",onmouseover:"this.style.color='#31C27C';",onmouseout:"this.style.color='black';"},slot:"reference"},[t._v("[更多]")])],1)],1),t._v(" "),i("div",{staticStyle:{"margin-top":"60px"}},[i("el-button",{staticStyle:{"background-color":"#31C27C"},attrs:{type:"primary",icon:"el-icon-caret-right",onmouseover:"this.style.backgroundColor='#2CAF6F';",onmouseout:"this.style.backgroundColor='#31C27C';"},on:{click:t.playAllSong}},[t._v("播放全部")])],1)])],1),t._v(" "),t._m(0),t._v(" "),i("el-row",[i("el-col",{attrs:{span:16,offset:3}},[i("div",{staticStyle:{margin:"auto"}},[i("el-table",{staticClass:"spHeight",staticStyle:{height:"100%",width:"100%","margin-left":"50px"},attrs:{data:t.songListView,stripe:"true"},on:{"cell-mouse-enter":t.handleMouseEnter,"cell-mouse-leave":t.handleMouseOut}},[i("el-table-column",{attrs:{type:"index",label:" ",index:t.indexMethod}}),t._v(" "),i("el-table-column",{attrs:{label:"歌曲",width:"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("router-link",{attrs:{to:{path:"/user/songdetail",query:{id:e.row.id}}}},[i("a",{staticStyle:{color:"black",cursor:"pointer","text-decoration":"none"},attrs:{href:"",onmouseover:"this.style.color='#31C27C';",onmouseout:"this.style.color='black';"}},[t._v(t._s(e.row.name))])])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:" ",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.Flag?i("span",[i("el-button",{attrs:{icon:"el-icon-caret-right",circle:""},on:{click:function(i){t.playSong(e.$index)}}})],1):t._e(),t._v(" "),e.row.Flag?i("span",[i("el-dropdown",{attrs:{trigger:"click",placement:"bottom-start"},on:{"visible-change":function(i){t.handle(e.row,i)},command:t.handleSongCommand}},[i("el-button",{attrs:{icon:"el-icon-plus",circle:""}}),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown",data:t.playlistList},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:{type:"playqueue",params:e.$index}}},[t._v("播放队列")]),t._v(" "),t.isLogin?i("div",[t._l(t.playlistList,function(a){return i("el-dropdown-item",{key:a.id,attrs:{command:{type:"playlist",param1:a.id,param2:e.row}}},[t._v(t._s(a.name))])}),t._v(" "),i("el-dropdown-item",{attrs:{command:"newplaylist",divided:""}},[t._v("添加到新歌单")])],2):i("el-dropdown-item",{attrs:{command:"login",divided:""}},[t._v("登录后添加到歌单")])],1)],1)],1):t._e(),t._v(" "),e.row.Flag?i("span",[i("el-button",{attrs:{icon:"el-icon-download",circle:""},on:{click:function(i){t.downloadSong(e.row)}}})],1):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"专辑",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("router-link",{attrs:{to:{path:"/user/albumdetail",query:{id:e.row.albumId}}}},[i("a",{staticStyle:{"margin-right":"50px",color:"black",cursor:"pointer","text-decoration":"none"},attrs:{href:"",onmouseover:"this.style.color='#31C27C';",onmouseout:"this.style.color='black';"}},[t._v(t._s(e.row.albumName))])])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"duration",label:"时长",width:"100"}})],1)],1)])],1),t._v(" "),i("el-pagination",{staticClass:"pagination",staticStyle:{"margin-top":"30px","margin-bottom":"30px"},attrs:{layout:"prev, pager, next","page-count":t.songPageCount},on:{"current-change":t.handleCurrentChange}}),t._v(" "),i("el-dialog",{attrs:{title:"创建歌单",visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-form",{ref:"playlist",attrs:{model:t.playlist,rules:t.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"歌单名称",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入歌单名称"},model:{value:t.playlist.name,callback:function(e){t.$set(t.playlist,"name",e)},expression:"playlist.name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"歌单简介",prop:"intro"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入歌单简介"},model:{value:t.playlist.intro,callback:function(e){t.$set(t.playlist,"intro",e)},expression:"playlist.intro"}})],1),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("完成")]),t._v(" "),i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")])],1)],1)],1),t._v(" "),t._m(1),t._v(" "),i("el-row",{staticStyle:{width:"1100px",height:"200px",margin:"auto","margin-left":"240px"}},[i("ul",{attrs:{id:"albumlist",data:"albumView"}},t._l(t.albumView,function(e){return i("li",{staticClass:"albumli",staticStyle:{"list-style":"none"}},[i("div",{staticClass:"album",staticStyle:{"margin-bottom":"500px"}},[i("router-link",{attrs:{to:{path:"/user/albumdetail",query:{id:e.id}}}},[i("img",{staticClass:"albumImage",attrs:{src:e.image,alt:""},on:{click:function(i){t.setAlbum(e)}}}),t._v(" "),i("p",{staticStyle:{color:"black",width:"180px"},attrs:{onmouseover:"this.style.color='#31C27C';",onmouseout:"this.style.color='black';"},on:{click:function(i){t.setAlbum(e)}}},[t._v(t._s(e.name))])])],1)])}))]),t._v(" "),i("div",{staticStyle:{clear:"both"}}),t._v(" "),i("el-pagination",{staticClass:"pagination",staticStyle:{"margin-top":"30px","margin-bottom":"30px"},attrs:{layout:"prev, pager, next","page-count":t.albumPageCount},on:{"current-change":t.handleCurrentChange2}})],1),t._v(" "),i("v-foot")],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{width:"900px",margin:"auto","margin-top":"50px"}},[e("p",{staticStyle:{"font-family":"'Microsoft YaHei'","font-size":"x-large","margin-left":"50px"}},[this._v("热门歌曲")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{width:"900px",margin:"auto"}},[e("p",{staticStyle:{"font-family":"'Microsoft YaHei'","font-size":"x-large","margin-left":"50px"}},[this._v("专辑")])])}]};var g=i("vSla")(u,p,!1,function(t){i("DX1M")},"data-v-39146628",null);e.default=g.exports}});
//# sourceMappingURL=11.215d05d5b6dae7a170e2.js.map